---
// src/components/NoteFooter.astro
---

<footer class="mt-16 py-8 border-t border-gray-200">
  <div class="container mx-auto px-4">
    <a 
      href="#"
      id="step-back-link"
      class="inline-flex items-center text-black-600 hover:text-blue-800 transition-colors"
      style="display: none;"
    >
      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
        <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd" />
      </svg>
      <span id="step-back-text">Step back: </span>
    </a>
  </div>
</footer>

<script>
  document.addEventListener('astro:page-load', () => {
    // Get the current page info
    const currentPage = {
      title: document.title,
      url: window.location.pathname
    };

    // Retrieve the navigation history from sessionStorage
    let navigationHistory = JSON.parse(sessionStorage.getItem('navigationHistory') || '[]');

    // Add the current page to the history if it's not the same as the last entry
    if (navigationHistory.length === 0 || navigationHistory[navigationHistory.length - 1].url !== currentPage.url) {
      navigationHistory.push(currentPage);
      sessionStorage.setItem('navigationHistory', JSON.stringify(navigationHistory));
    }

    // Get the previous page (if exists)
    const previousPage = navigationHistory[navigationHistory.length - 2];

    // Update the "Step back" link
    const stepBackLink = document.getElementById('step-back-link');
    const stepBackText = document.getElementById('step-back-text');

    if (previousPage) {
      stepBackLink.href = previousPage.url;
      stepBackText.textContent = `Step back: ${previousPage.title}`;
      stepBackLink.style.display = 'inline-flex';
    }
  });
</script>